// Generated by CoffeeScript 1.9.0
(function() {
  var NodeChat;

  NodeChat = (function() {
    function NodeChat($, User) {
      this.window = window;
      this.$ = $;
      this._initUser();
      if (!this.user.loggedIn) {
        this.showLoginWindow();
      }
    }

    NodeChat.prototype._initUser = function() {
      var opts;
      opts = {
        onChangeNick: function(nick) {
          return $('.b-info-bar__nick').text(nick);
        }
      };
      return this.user = new User(opts);
    };

    NodeChat.prototype._setupUi = function() {
      return this.node = $('<div/>');
    };

    NodeChat.prototype.showLoginWindow = function() {
      var $node, template, title;
      title = 'Введите ник';
      template = "<div class=\"j-popup b-popup\">\n  <a class=\"j-popup__close b-popup__close\" href=\"#\"></a>\n  <div class=\"b-popup__title\">" + title + "</div>\n  <input type=\"text\" class=\"j-popup__nick b-popup__nick\">\n  <button class=\"j-popup__ok b-popup__ok\">ok</button>\n</div>";
      return $node = $(template).on('click.popup', '.j-popup__close, .j-popup__ok', (function(_this) {
        return function(e) {
          var nick;
          e.preventDefault();
          nick = $node.find('.j-popup__nick').val();
          if (nick) {
            _this.user.setNick(nick);
          }
          return $node.remove();
        };
      })(this)).appendTo('body');
    };

    return NodeChat;

  })();

  window.NodeChat = NodeChat;

}).call(this);

//# sourceMappingURL=NodeChat.js.map
